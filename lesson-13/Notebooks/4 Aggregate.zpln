{"id":"2JQCEY5AG","name":"4 Aggregate","paragraphs":[{"text":"import org.apache.spark.sql._\nimport org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"Feb 19, 2024, 9:05:03 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708335930355_659644826","id":"paragraph_1692529482267_551661357","dateCreated":"Feb 19, 2024, 12:45:30 PM","dateStarted":"Feb 19, 2024, 9:05:03 PM","dateFinished":"Feb 19, 2024, 9:05:03 PM","status":"FINISHED"},{"text":"val data = Seq(\n    (\"Jean-Georges\", \"Perrin\", \"NC\", 1, 300, 1551903533),\n    (\"Jean-Georges\", \"Perrin\", \"NC\", 2, 120, 1551903567),\n    (\"Jean-Georges\", \"Perrin\", \"CA\" ,4, 75, 1551903599),\n    (\"Holden\", \"Karau\", \"CA\" , 6, 37, 1551904299),\n    (\"Ginni\", \"Rometty\", \"NY\", 7, 91, 1551916792),\n    (\"Holden\", \"Karau\", \"CA\", 4, 153, 1552876129)\n).toDF(\"firstName\", \"lastName\", \"state\", \"quantity\", \"revenue\", \"timestamp\")\n\ndata.show()","user":"anonymous","dateUpdated":"Feb 19, 2024, 9:05:10 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+\n|   firstName|lastName|state|quantity|revenue| timestamp|\n+------------+--------+-----+--------+-------+----------+\n|Jean-Georges|  Perrin|   NC|       1|    300|1551903533|\n|Jean-Georges|  Perrin|   NC|       2|    120|1551903567|\n|Jean-Georges|  Perrin|   CA|       4|     75|1551903599|\n|      Holden|   Karau|   CA|       6|     37|1551904299|\n|       Ginni| Rometty|   NY|       7|     91|1551916792|\n|      Holden|   Karau|   CA|       4|    153|1552876129|\n+------------+--------+-----+--------+-------+----------+\n\n\u001b[1m\u001b[34mdata\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 4 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708335930355_371827152","id":"paragraph_1692529493082_1169013294","dateCreated":"Feb 19, 2024, 12:45:30 PM","dateStarted":"Feb 19, 2024, 9:05:10 PM","dateFinished":"Feb 19, 2024, 9:05:11 PM","status":"FINISHED"},{"text":"val aggDf = data\n            .groupBy($\"firstName\", $\"lastName\", $\"state\")\n            .agg(\n                sum(\"quantity\").as(\"sum_qty\"),\n                sum(\"revenue\").as(\"sum_rev\"),\n                avg(\"revenue\").as(\"avg_rev\"))\n\naggDf.show()","user":"anonymous","dateUpdated":"Feb 19, 2024, 9:05:25 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+-------+-------+-------+\n|   firstName|lastName|state|sum_qty|sum_rev|avg_rev|\n+------------+--------+-----+-------+-------+-------+\n|Jean-Georges|  Perrin|   NC|      3|    420|  210.0|\n|Jean-Georges|  Perrin|   CA|      4|     75|   75.0|\n|      Holden|   Karau|   CA|     10|    190|   95.0|\n|       Ginni| Rometty|   NY|      7|     91|   91.0|\n+------------+--------+-----+-------+-------+-------+\n\n\u001b[1m\u001b[34maggDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 4 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4044/jobs/job?id=72"},{"jobUrl":"http://ubuntu:4044/jobs/job?id=73"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708335930355_1411947806","id":"paragraph_1692529507751_1053055265","dateCreated":"Feb 19, 2024, 12:45:30 PM","dateStarted":"Feb 19, 2024, 9:05:25 PM","dateFinished":"Feb 19, 2024, 9:05:25 PM","status":"FINISHED"},{"user":"anonymous","dateUpdated":"Feb 19, 2024, 9:06:05 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4044/jobs/job?id=74"},{"jobUrl":"http://ubuntu:4044/jobs/job?id=75"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708335930356_864908128","id":"paragraph_1692529519810_36528303","dateCreated":"Feb 19, 2024, 12:45:30 PM","status":"FINISHED","text":"val aggDf2 = data\n            .groupBy($\"firstName\", $\"lastName\", $\"state\")\n            .agg(\n                sum(\"quantity\"),\n                sum(\"revenue\"),\n                avg(\"revenue\"))\n\naggDf2.show()","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+-------------+------------+------------+\n|   firstName|lastName|state|sum(quantity)|sum(revenue)|avg(revenue)|\n+------------+--------+-----+-------------+------------+------------+\n|Jean-Georges|  Perrin|   NC|            3|         420|       210.0|\n|Jean-Georges|  Perrin|   CA|            4|          75|        75.0|\n|      Holden|   Karau|   CA|           10|         190|        95.0|\n|       Ginni| Rometty|   NY|            7|          91|        91.0|\n+------------+--------+-----+-------------+------------+------------+\n\n\u001b[1m\u001b[34maggDf2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 4 more fields]\n"}]},"dateStarted":"Feb 19, 2024, 9:06:05 PM","dateFinished":"Feb 19, 2024, 9:06:05 PM"}],"info":{},"noteForms":{},"noteParams":{},"angularObjects":{}}