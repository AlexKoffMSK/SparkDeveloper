{"id":"2JS459FXH","name":"1 Functions","paragraphs":[{"text":"import org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:06:35 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions._\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539212_572773156","id":"paragraph_1692530381329_1029331294","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:06:35 PM","dateFinished":"Feb 19, 2024, 12:06:35 PM","status":"FINISHED"},{"text":"val data = Seq(\n    (\"Jean-Georges\", \"Perrin\", \"NC\", 1, 300, 1551903533),\n    (\"Jean-Georges\", \"Perrin\", \"NC\", 2, 120, 1551903567),\n    (\"Jean-Georges\", \"Perrin\", \"CA\" ,4, 75, 1551903599),\n    (\"Holden\", \"Karau\", \"CA\" , 6, 37, 1551904299),\n    (\"Ginni\", \"Rometty\", \"NY\", 7, 91, 1551916792),\n    (\"Holden\", \"Karau\", \"CA\", 4, 153, 1552876129)\n).toDF(\"firstName\", \"lastName\", \"state\", \"quantity\", \"revenue\", \"timestamp\")\n\ndata.show()","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:06:42 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":349}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+\n|   firstName|lastName|state|quantity|revenue| timestamp|\n+------------+--------+-----+--------+-------+----------+\n|Jean-Georges|  Perrin|   NC|       1|    300|1551903533|\n|Jean-Georges|  Perrin|   NC|       2|    120|1551903567|\n|Jean-Georges|  Perrin|   CA|       4|     75|1551903599|\n|      Holden|   Karau|   CA|       6|     37|1551904299|\n|       Ginni| Rometty|   NY|       7|     91|1551916792|\n|      Holden|   Karau|   CA|       4|    153|1552876129|\n+------------+--------+-----+--------+-------+----------+\n\n\u001b[1m\u001b[34mdata\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 4 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539212_776568436","id":"paragraph_1692542704570_1012243133","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:06:42 PM","dateFinished":"Feb 19, 2024, 12:06:43 PM","status":"FINISHED"},{"text":"data.printSchema()","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:06:52 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":320}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- firstName: string (nullable = true)\n |-- lastName: string (nullable = true)\n |-- state: string (nullable = true)\n |-- quantity: integer (nullable = false)\n |-- revenue: integer (nullable = false)\n |-- timestamp: integer (nullable = false)\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539212_2083149958","id":"paragraph_1692542716879_2143940182","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:06:52 PM","dateFinished":"Feb 19, 2024, 12:06:52 PM","status":"FINISHED"},{"text":"%md\n\n## Array Functions","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:39 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Array Functions</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539212_571178269","id":"paragraph_1692542749533_1803168522","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"READY"},{"text":"val datak2 = data\n                .withColumn(\"k2v\", array($\"firstName\", $\"lastName\", $\"state\"))\n                .withColumn(\"k2n\", array(lit(\"FirstName\"), lit(\"LastName\"), lit(\"State\")))\n\ndatak2.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:07:01 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":349}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |k2v                       |k2n                         |\n+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[Jean-Georges, Perrin, NC]|[FirstName, LastName, State]|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[Jean-Georges, Perrin, NC]|[FirstName, LastName, State]|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[Jean-Georges, Perrin, CA]|[FirstName, LastName, State]|\n|Holden      |Karau   |CA   |6       |37     |1551904299|[Holden, Karau, CA]       |[FirstName, LastName, State]|\n|Ginni       |Rometty |NY   |7       |91     |1551916792|[Ginni, Rometty, NY]      |[FirstName, LastName, State]|\n|Holden      |Karau   |CA   |4       |153    |1552876129|[Holden, Karau, CA]       |[FirstName, LastName, State]|\n+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+\n\n\u001b[1m\u001b[34mdatak2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 6 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539212_1588014990","id":"paragraph_1692542771743_1296142053","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:07:01 PM","dateFinished":"Feb 19, 2024, 12:07:01 PM","status":"FINISHED"},{"text":"datak2.where(array_contains($\"k2v\", \"CA\")).show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:07:09 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":233}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |k2v                       |k2n                         |\n+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[Jean-Georges, Perrin, CA]|[FirstName, LastName, State]|\n|Holden      |Karau   |CA   |6       |37     |1551904299|[Holden, Karau, CA]       |[FirstName, LastName, State]|\n|Holden      |Karau   |CA   |4       |153    |1552876129|[Holden, Karau, CA]       |[FirstName, LastName, State]|\n+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539212_1402629185","id":"paragraph_1692542793040_920577877","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:07:09 PM","dateFinished":"Feb 19, 2024, 12:07:10 PM","status":"FINISHED"},{"text":"%md\n\n## Map Functions","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:39 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Map Functions</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539213_1271470172","id":"paragraph_1692542816406_1783262231","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"READY"},{"text":"val datak2m = data.withColumn(\"k2m\", map(lit(\"FirstName\"), $\"firstName\", lit(\"LastName\"), $\"lastName\", lit(\"State\"), $\"state\"))\n\ndatak2m.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:07:17 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":360}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+------------------------------------------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |k2m                                                         |\n+------------+--------+-----+--------+-------+----------+------------------------------------------------------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|{FirstName -> Jean-Georges, LastName -> Perrin, State -> NC}|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|{FirstName -> Jean-Georges, LastName -> Perrin, State -> NC}|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|{FirstName -> Jean-Georges, LastName -> Perrin, State -> CA}|\n|Holden      |Karau   |CA   |6       |37     |1551904299|{FirstName -> Holden, LastName -> Karau, State -> CA}       |\n|Ginni       |Rometty |NY   |7       |91     |1551916792|{FirstName -> Ginni, LastName -> Rometty, State -> NY}      |\n|Holden      |Karau   |CA   |4       |153    |1552876129|{FirstName -> Holden, LastName -> Karau, State -> CA}       |\n+------------+--------+-----+--------+-------+----------+------------------------------------------------------------+\n\n\u001b[1m\u001b[34mdatak2m\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 5 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539213_75403543","id":"paragraph_1692542852408_1600382709","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:07:17 PM","dateFinished":"Feb 19, 2024, 12:07:18 PM","status":"FINISHED"},{"text":"val datak2ma = datak2.withColumn(\"k2m\", map_from_arrays($\"k2n\", $\"k2v\"))\n\ndatak2ma.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:07:27 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":366}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+------------------------------------------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |k2v                       |k2n                         |k2m                                                         |\n+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+------------------------------------------------------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[Jean-Georges, Perrin, NC]|[FirstName, LastName, State]|{FirstName -> Jean-Georges, LastName -> Perrin, State -> NC}|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[Jean-Georges, Perrin, NC]|[FirstName, LastName, State]|{FirstName -> Jean-Georges, LastName -> Perrin, State -> NC}|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[Jean-Georges, Perrin, CA]|[FirstName, LastName, State]|{FirstName -> Jean-Georges, LastName -> Perrin, State -> CA}|\n|Holden      |Karau   |CA   |6       |37     |1551904299|[Holden, Karau, CA]       |[FirstName, LastName, State]|{FirstName -> Holden, LastName -> Karau, State -> CA}       |\n|Ginni       |Rometty |NY   |7       |91     |1551916792|[Ginni, Rometty, NY]      |[FirstName, LastName, State]|{FirstName -> Ginni, LastName -> Rometty, State -> NY}      |\n|Holden      |Karau   |CA   |4       |153    |1552876129|[Holden, Karau, CA]       |[FirstName, LastName, State]|{FirstName -> Holden, LastName -> Karau, State -> CA}       |\n+------------+--------+-----+--------+-------+----------+--------------------------+----------------------------+------------------------------------------------------------+\n\n\u001b[1m\u001b[34mdatak2ma\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 7 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539213_918281178","id":"paragraph_1692542868591_649771328","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:07:27 PM","dateFinished":"Feb 19, 2024, 12:07:27 PM","status":"FINISHED"},{"text":"val names = data.columns.slice(0, 3)\nval datak2ma2 = data\n                    .withColumn(\"names\", lit(names))\n                    .withColumn(\"k2v\", array($\"firstName\", $\"lastName\", $\"state\"))\n                    .withColumn(\"k2m\", map_from_arrays($\"names\", $\"k2v\"))\n\ndatak2ma2.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:07:36 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":354}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+----------------------------+--------------------------+------------------------------------------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |names                       |k2v                       |k2m                                                         |\n+------------+--------+-----+--------+-------+----------+----------------------------+--------------------------+------------------------------------------------------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[firstName, lastName, state]|[Jean-Georges, Perrin, NC]|{firstName -> Jean-Georges, lastName -> Perrin, state -> NC}|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[firstName, lastName, state]|[Jean-Georges, Perrin, NC]|{firstName -> Jean-Georges, lastName -> Perrin, state -> NC}|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[firstName, lastName, state]|[Jean-Georges, Perrin, CA]|{firstName -> Jean-Georges, lastName -> Perrin, state -> CA}|\n|Holden      |Karau   |CA   |6       |37     |1551904299|[firstName, lastName, state]|[Holden, Karau, CA]       |{firstName -> Holden, lastName -> Karau, state -> CA}       |\n|Ginni       |Rometty |NY   |7       |91     |1551916792|[firstName, lastName, state]|[Ginni, Rometty, NY]      |{firstName -> Ginni, lastName -> Rometty, state -> NY}      |\n|Holden      |Karau   |CA   |4       |153    |1552876129|[firstName, lastName, state]|[Holden, Karau, CA]       |{firstName -> Holden, lastName -> Karau, state -> CA}       |\n+------------+--------+-----+--------+-------+----------+----------------------------+--------------------------+------------------------------------------------------------+\n\n\u001b[1m\u001b[34mnames\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(firstName, lastName, state)\n\u001b[1m\u001b[34mdatak2ma2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 7 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539213_497794693","id":"paragraph_1692717946899_1528119625","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:07:36 PM","dateFinished":"Feb 19, 2024, 12:07:37 PM","status":"FINISHED"},{"text":"%md\n\n## Date and Timestamp Functions","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:39 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Date and Timestamp Functions</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539213_1236294316","id":"paragraph_1692542889927_317733757","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"READY"},{"text":"val datat = data\n                .withColumn(\"recordTimestamp\", to_timestamp($\"timestamp\"))\n                .withColumn(\"current\", current_timestamp)\n\ndatat.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:07:47 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":345}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+-------------------+--------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |recordTimestamp    |current                   |\n+------------+--------+-----+--------+-------+----------+-------------------+--------------------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|2019-03-06 23:18:53|2024-02-19 12:07:47.661843|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|2019-03-06 23:19:27|2024-02-19 12:07:47.661843|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|2019-03-06 23:19:59|2024-02-19 12:07:47.661843|\n|Holden      |Karau   |CA   |6       |37     |1551904299|2019-03-06 23:31:39|2024-02-19 12:07:47.661843|\n|Ginni       |Rometty |NY   |7       |91     |1551916792|2019-03-07 02:59:52|2024-02-19 12:07:47.661843|\n|Holden      |Karau   |CA   |4       |153    |1552876129|2019-03-18 05:28:49|2024-02-19 12:07:47.661843|\n+------------+--------+-----+--------+-------+----------+-------------------+--------------------------+\n\n\u001b[1m\u001b[34mdatat\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 6 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_1805781182","id":"paragraph_1692542910552_764117787","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:07:47 PM","dateFinished":"Feb 19, 2024, 12:07:47 PM","status":"FINISHED"},{"text":"datat.select($\"recordTimestamp\", $\"current\", datediff($\"current\", $\"recordTimestamp\").as(\"date_diff\")).show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:08:02 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":347}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+--------------------------+---------+\n|recordTimestamp    |current                   |date_diff|\n+-------------------+--------------------------+---------+\n|2019-03-06 23:18:53|2024-02-19 12:08:02.159274|1811     |\n|2019-03-06 23:19:27|2024-02-19 12:08:02.159274|1811     |\n|2019-03-06 23:19:59|2024-02-19 12:08:02.159274|1811     |\n|2019-03-06 23:31:39|2024-02-19 12:08:02.159274|1811     |\n|2019-03-07 02:59:52|2024-02-19 12:08:02.159274|1810     |\n|2019-03-18 05:28:49|2024-02-19 12:08:02.159274|1799     |\n+-------------------+--------------------------+---------+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_307338248","id":"paragraph_1692542925767_1256041709","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:08:02 PM","dateFinished":"Feb 19, 2024, 12:08:02 PM","status":"FINISHED"},{"text":"%md \n\n## JSON Functions","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:39 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>JSON Functions</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_470228069","id":"paragraph_1692542949592_1067925904","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"READY"},{"text":"val datak2j = datak2m.withColumn(\"k2j\", to_json($\"k2m\"))\n\ndatak2j.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:08:12 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":358}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+------------------------------------------------------------+-------------------------------------------------------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |k2m                                                         |k2j                                                          |\n+------------+--------+-----+--------+-------+----------+------------------------------------------------------------+-------------------------------------------------------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|{FirstName -> Jean-Georges, LastName -> Perrin, State -> NC}|{\"FirstName\":\"Jean-Georges\",\"LastName\":\"Perrin\",\"State\":\"NC\"}|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|{FirstName -> Jean-Georges, LastName -> Perrin, State -> NC}|{\"FirstName\":\"Jean-Georges\",\"LastName\":\"Perrin\",\"State\":\"NC\"}|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|{FirstName -> Jean-Georges, LastName -> Perrin, State -> CA}|{\"FirstName\":\"Jean-Georges\",\"LastName\":\"Perrin\",\"State\":\"CA\"}|\n|Holden      |Karau   |CA   |6       |37     |1551904299|{FirstName -> Holden, LastName -> Karau, State -> CA}       |{\"FirstName\":\"Holden\",\"LastName\":\"Karau\",\"State\":\"CA\"}       |\n|Ginni       |Rometty |NY   |7       |91     |1551916792|{FirstName -> Ginni, LastName -> Rometty, State -> NY}      |{\"FirstName\":\"Ginni\",\"LastName\":\"Rometty\",\"State\":\"NY\"}      |\n|Holden      |Karau   |CA   |4       |153    |1552876129|{FirstName -> Holden, LastName -> Karau, State -> CA}       |{\"FirstName\":\"Holden\",\"LastName\":\"Karau\",\"State\":\"CA\"}       |\n+------------+--------+-----+--------+-------+----------+------------------------------------------------------------+-------------------------------------------------------------+\n\n\u001b[1m\u001b[34mdatak2j\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 6 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_103605617","id":"paragraph_1692542987765_834029350","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:08:12 PM","dateFinished":"Feb 19, 2024, 12:08:12 PM","status":"FINISHED"},{"text":"%md\n\n## Generator Functions","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:39 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Generator Functions</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_2021795495","id":"paragraph_1692543001311_1158893645","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"READY"},{"text":"val data2 = data\n                .withColumn(\"a1\", array(lit(1), lit(2), lit(3), lit(4), lit(5)))\n                .withColumn(\"a2\", lit((1 to 5).toArray))\n\ndata2.show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:08:21 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":346}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+---------------+---------------+\n|firstName   |lastName|state|quantity|revenue|timestamp |a1             |a2             |\n+------------+--------+-----+--------+-------+----------+---------------+---------------+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|\n|Holden      |Karau   |CA   |6       |37     |1551904299|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|\n|Ginni       |Rometty |NY   |7       |91     |1551916792|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|\n|Holden      |Karau   |CA   |4       |153    |1552876129|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|\n+------------+--------+-----+--------+-------+----------+---------------+---------------+\n\n\u001b[1m\u001b[34mdata2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 6 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_610883876","id":"paragraph_1692543025486_659920498","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:08:21 PM","dateFinished":"Feb 19, 2024, 12:08:21 PM","status":"FINISHED"},{"text":"data2.withColumn(\"dummy\", explode($\"a1\")).show(false)","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:08:35 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":702}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+---------------+---------------+-----+\n|firstName   |lastName|state|quantity|revenue|timestamp |a1             |a2             |dummy|\n+------------+--------+-----+--------+-------+----------+---------------+---------------+-----+\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|1    |\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|2    |\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|3    |\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|4    |\n|Jean-Georges|Perrin  |NC   |1       |300    |1551903533|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|5    |\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|1    |\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|2    |\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|3    |\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|4    |\n|Jean-Georges|Perrin  |NC   |2       |120    |1551903567|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|5    |\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|1    |\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|2    |\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|3    |\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|4    |\n|Jean-Georges|Perrin  |CA   |4       |75     |1551903599|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|5    |\n|Holden      |Karau   |CA   |6       |37     |1551904299|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|1    |\n|Holden      |Karau   |CA   |6       |37     |1551904299|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|2    |\n|Holden      |Karau   |CA   |6       |37     |1551904299|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|3    |\n|Holden      |Karau   |CA   |6       |37     |1551904299|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|4    |\n|Holden      |Karau   |CA   |6       |37     |1551904299|[1, 2, 3, 4, 5]|[1, 2, 3, 4, 5]|5    |\n+------------+--------+-----+--------+-------+----------+---------------+---------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4044/jobs/job?id=12"},{"jobUrl":"http://ubuntu:4044/jobs/job?id=13"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_1628856001","id":"paragraph_1692543038743_1050448273","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:08:35 PM","dateFinished":"Feb 19, 2024, 12:08:35 PM","status":"FINISHED"},{"text":"%md\n\n## Window Functions","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:39 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Window Functions</h2>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_58004975","id":"paragraph_1692543064845_1283786805","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"READY"},{"text":"import org.apache.spark.sql.expressions.Window\n\nval windowSpec  = Window.partitionBy(\"firstName\", \"lastName\").orderBy(\"state\")","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:08:44 PM","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\n\u001b[1m\u001b[34mwindowSpec\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@47b8cb92\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_493884636","id":"paragraph_1692543096555_266229459","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:08:44 PM","dateFinished":"Feb 19, 2024, 12:08:45 PM","status":"FINISHED"},{"text":"val dataw = data.withColumn(\"row_number\", row_number().over(windowSpec))\n\ndataw.show","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:08:59 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":351}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+----------+\n|   firstName|lastName|state|quantity|revenue| timestamp|row_number|\n+------------+--------+-----+--------+-------+----------+----------+\n|       Ginni| Rometty|   NY|       7|     91|1551916792|         1|\n|      Holden|   Karau|   CA|       6|     37|1551904299|         1|\n|      Holden|   Karau|   CA|       4|    153|1552876129|         2|\n|Jean-Georges|  Perrin|   CA|       4|     75|1551903599|         1|\n|Jean-Georges|  Perrin|   NC|       1|    300|1551903533|         2|\n|Jean-Georges|  Perrin|   NC|       2|    120|1551903567|         3|\n+------------+--------+-----+--------+-------+----------+----------+\n\n\u001b[1m\u001b[34mdataw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [firstName: string, lastName: string ... 5 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4044/jobs/job?id=14"},{"jobUrl":"http://ubuntu:4044/jobs/job?id=15"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_1345129009","id":"paragraph_1692543110061_1869286445","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:08:59 PM","dateFinished":"Feb 19, 2024, 12:08:59 PM","status":"FINISHED"},{"text":"dataw.where($\"row_number\" === 1).show()","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:09:13 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":237}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+----------+\n|   firstName|lastName|state|quantity|revenue| timestamp|row_number|\n+------------+--------+-----+--------+-------+----------+----------+\n|       Ginni| Rometty|   NY|       7|     91|1551916792|         1|\n|      Holden|   Karau|   CA|       6|     37|1551904299|         1|\n|Jean-Georges|  Perrin|   CA|       4|     75|1551903599|         1|\n+------------+--------+-----+--------+-------+----------+----------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4044/jobs/job?id=16"},{"jobUrl":"http://ubuntu:4044/jobs/job?id=17"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_124050273","id":"paragraph_1692543131521_57166390","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:09:13 PM","dateFinished":"Feb 19, 2024, 12:09:13 PM","status":"FINISHED"},{"text":"dataw.withColumn(\"revenue2\", nth_value($\"revenue\", 2).over(windowSpec)).show()","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:09:25 PM","progress":0,"config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{"bdtMeta":{"inlay":{"size":{"height":352}}}},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------+-----+--------+-------+----------+----------+--------+\n|   firstName|lastName|state|quantity|revenue| timestamp|row_number|revenue2|\n+------------+--------+-----+--------+-------+----------+----------+--------+\n|       Ginni| Rometty|   NY|       7|     91|1551916792|         1|    NULL|\n|      Holden|   Karau|   CA|       6|     37|1551904299|         1|     153|\n|      Holden|   Karau|   CA|       4|    153|1552876129|         2|     153|\n|Jean-Georges|  Perrin|   CA|       4|     75|1551903599|         1|    NULL|\n|Jean-Georges|  Perrin|   NC|       1|    300|1551903533|         2|     300|\n|Jean-Georges|  Perrin|   NC|       2|    120|1551903567|         3|     300|\n+------------+--------+-----+--------+-------+----------+----------+--------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4044/jobs/job?id=18"},{"jobUrl":"http://ubuntu:4044/jobs/job?id=19"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_479958354","id":"paragraph_1692543152944_1632149846","dateCreated":"Feb 19, 2024, 12:05:39 PM","dateStarted":"Feb 19, 2024, 12:09:25 PM","dateFinished":"Feb 19, 2024, 12:09:25 PM","status":"FINISHED"},{"text":"","user":"anonymous","dateUpdated":"Feb 19, 2024, 12:05:47 PM","progress":0,"config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1708333539214_715319277","id":"paragraph_1692543187061_1253326282","dateCreated":"Feb 19, 2024, 12:05:39 PM","status":"FINISHED"}],"info":{},"noteForms":{},"noteParams":{},"angularObjects":{}}