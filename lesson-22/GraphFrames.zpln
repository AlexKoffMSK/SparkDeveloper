{"id":"2JD8AHT8M","name":"GraphFrames","paragraphs":[{"id":"paragraph_1711531700482_779446169","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"### Creating GraphFrames"},{"id":"paragraph_1711531534353_1096786942","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.GraphFrame\n\n// Vertex DataFrame\nval v = spark.createDataFrame(List(\n  (\"a\", \"Alice\", 34),\n  (\"b\", \"Bob\", 36),\n  (\"c\", \"Charlie\", 30),\n  (\"d\", \"David\", 29),\n  (\"e\", \"Esther\", 32),\n  (\"f\", \"Fanny\", 36),\n  (\"g\", \"Gabby\", 60)\n)).toDF(\"id\", \"name\", \"age\")\n\n// Edge DataFrame\nval e = spark.createDataFrame(List(\n  (\"a\", \"b\", \"friend\"),\n  (\"b\", \"c\", \"follow\"),\n  (\"c\", \"b\", \"follow\"),\n  (\"f\", \"c\", \"follow\"),\n  (\"e\", \"f\", \"follow\"),\n  (\"e\", \"d\", \"friend\"),\n  (\"d\", \"a\", \"friend\"),\n  (\"a\", \"e\", \"friend\")\n)).toDF(\"src\", \"dst\", \"relationship\")\n\n// Create a GraphFrame\nval g = GraphFrame(v, e)"},{"id":"paragraph_1711531751513_1316869560","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"### Basic graph and DataFrame queries","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:38:29 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711531751513_1316869560","dateCreated":"Mar 27, 2024, 12:29:11 PM","dateStarted":"Mar 27, 2024, 12:38:29 PM","dateFinished":"Mar 27, 2024, 12:38:30 PM","status":"FINISHED"},{"id":"paragraph_1711531647442_1878379803","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Display the vertex and edge DataFrames\ng.vertices.show()\n\ng.edges.show()"},{"id":"paragraph_1711531647442_1878379803","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.apache.spark.sql.DataFrame\n\n// Get a DataFrame with columns \"id\" and \"inDeg\" (in-degree)\nval vertexInDegrees: DataFrame = g.inDegrees\n\nvertexInDegrees.show()"},{"id":"paragraph_1711531838581_1053619540","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"// Find the youngest user's age in the graph.\n// This queries the vertex DataFrame.\ng.vertices.groupBy().min(\"age\").show()","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:32:32 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+\n| id|inDegree|\n+---+--------+\n|  b|       2|\n|  c|       2|\n|  f|       1|\n|  d|       1|\n|  a|       1|\n|  e|       1|\n+---+--------+\n\nimport org.apache.spark.sql.DataFrame\n\u001b[1m\u001b[34mvertexInDegrees\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, inDegree: int]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=86"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=87"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711531838581_1053619540","dateCreated":"Mar 27, 2024, 12:30:38 PM","dateStarted":"Mar 27, 2024, 12:32:32 PM","dateFinished":"Mar 27, 2024, 12:32:33 PM","status":"FINISHED"},{"id":"paragraph_1711531937644_1617502821","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"// Count the number of \"follows\" in the graph.\n// This queries the edge DataFrame.\nval numFollows = g.edges.filter(\"relationship = 'follow'\").count()","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:34:56 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|min(age)|\n+--------+\n|      29|\n+--------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=88"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=89"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711531937644_1617502821","dateCreated":"Mar 27, 2024, 12:32:17 PM","dateStarted":"Mar 27, 2024, 12:34:56 PM","dateFinished":"Mar 27, 2024, 12:34:56 PM","status":"FINISHED"},{"id":"paragraph_1711532107784_1222910431","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"### Motif finding","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:35:15 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mnumFollows\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 4\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=90"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=91"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711532107784_1222910431","dateCreated":"Mar 27, 2024, 12:35:07 PM","dateStarted":"Mar 27, 2024, 12:35:15 PM","dateFinished":"Mar 27, 2024, 12:35:15 PM","status":"FINISHED"},{"id":"paragraph_1711532134800_35777632","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"import org.apache.spark.sql.Column\nimport org.apache.spark.sql.functions.{col, when}\nimport org.graphframes.{examples,GraphFrame}\n\nval g: GraphFrame = examples.Graphs.friends\n\n// Find chains of 4 vertices.\nval chain4 = g.find(\"(a)-[ab]->(b); (b)-[bc]->(c); (c)-[cd]->(d)\")\n\n// Query on sequence, with state (cnt)\n//  (a) Define method for updating state given the next element of the motif.\ndef sumFriends(cnt: Column, relationship: Column): Column = {\n  when(relationship === \"friend\", cnt + 1).otherwise(cnt)\n}\n//  (b) Use sequence operation to apply method to sequence of elements in motif.\n//      In this case, the elements are the 3 edges.\nval condition = { Seq(\"ab\", \"bc\", \"cd\")\n  .foldLeft(lit(0))((cnt, e) => sumFriends(cnt, col(e)(\"relationship\"))) }\n//  (c) Apply filter to DataFrame.\nval chainWith2Friends2 = chain4.where(condition >= 2)\nchainWith2Friends2.show()"},{"id":"paragraph_1711532702214_20269842","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"### Subgraphs"},{"id":"paragraph_1711532708219_501279602","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Select subgraph of users older than 30, and relationships of type \"friend\".\n// Drop isolated vertices (users) which are not contained in any edges (relationships).\nval g1 = g.filterVertices(\"age > 30\").filterEdges(\"relationship = 'friend'\").dropIsolatedVertices()","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:45:23 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mg1\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711532708219_501279602","dateCreated":"Mar 27, 2024, 12:45:08 PM","dateStarted":"Mar 27, 2024, 12:45:23 PM","dateFinished":"Mar 27, 2024, 12:45:23 PM","status":"FINISHED"},{"id":"paragraph_1711532746241_698807453","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Select subgraph based on edges \"e\" of type \"follow\"\n// pointing from a younger user \"a\" to an older user \"b\".\nval paths = { g.find(\"(a)-[e]->(b)\")\n  .filter(\"e.relationship = 'follow'\")\n  .filter(\"a.age < b.age\") }\n\n// \"paths\" contains vertex info. Extract the edges.\nval e2 = paths.select(\"e.src\", \"e.dst\", \"e.relationship\")\n// In Spark 1.5+, the user may simplify this call:\n//  val e2 = paths.select(\"e.*\")\n\n// Construct the subgraph\nval g2 = GraphFrame(g.vertices, e2)"},{"id":"paragraph_1711533232653_914584212","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"### Graph algorithms"},{"id":"paragraph_1711533246660_718464496","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"#### Breadth-first search (BFS)"},{"id":"paragraph_1711533220643_426313635","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Search from \"Esther\" for users of age < 32.\nval paths = g.bfs.fromExpr(\"name = 'Esther'\").toExpr(\"age < 32\").run()\npaths.show()\n\n// Specify edge filters or max path lengths.\n{ g.bfs.fromExpr(\"name = 'Esther'\").toExpr(\"age < 32\")\n  .edgeFilter(\"relationship != 'friend'\")\n  .maxPathLength(3).run() }","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:54:19 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------+--------------+\n|           from|            e0|            to|\n+---------------+--------------+--------------+\n|{e, Esther, 32}|{e, d, friend}|{d, David, 29}|\n+---------------+--------------+--------------+\n\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mpaths\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [from: struct<id: string, name: string ... 1 more field>, e0: struct<src: string, dst: string ... 1 more field> ... 1 more field]\n\u001b[1m\u001b[34mres44\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [from: struct<id: string, name: string ... 1 more field>, e0: struct<src: string, dst: string ... 1 more field> ... 3 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=102"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=103"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=104"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=105"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=106"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=107"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=108"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=109"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=110"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=111"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=112"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=113"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=114"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=115"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=116"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=117"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=118"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=119"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=120"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533220643_426313635","dateCreated":"Mar 27, 2024, 12:53:40 PM","dateStarted":"Mar 27, 2024, 12:54:19 PM","dateFinished":"Mar 27, 2024, 12:54:21 PM","status":"FINISHED"},{"id":"paragraph_1711533279681_629703925","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"#### Connected components"},{"id":"paragraph_1711533286684_174635908","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\nspark.sparkContext.setCheckpointDir(\"checkpoint\")\n\nval result = g.connectedComponents.run()\nresult.select(\"id\", \"component\").orderBy(\"component\").show()","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:56:33 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---------+\n| id|component|\n+---+---------+\n|  a|        0|\n|  c|        0|\n|  e|        0|\n|  d|        0|\n|  b|        0|\n|  f|        0|\n|  g|        6|\n+---+---------+\n\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mresult\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, name: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=121"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=122"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=123"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=124"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=125"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=126"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=127"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=128"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=129"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=130"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=131"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=132"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=133"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=134"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=135"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=136"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=137"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=138"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=139"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=140"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=141"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=142"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=143"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=144"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=145"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=146"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=147"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=148"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=149"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=150"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=151"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=152"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=153"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=154"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=155"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=156"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=157"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=158"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=159"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=160"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=161"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=162"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=163"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533286684_174635908","dateCreated":"Mar 27, 2024, 12:54:46 PM","dateStarted":"Mar 27, 2024, 12:56:33 PM","dateFinished":"Mar 27, 2024, 12:56:42 PM","status":"FINISHED"},{"id":"paragraph_1711533423788_651799814","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"#### Strongly connected components"},{"id":"paragraph_1711533435793_1409036222","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\nval result = g.stronglyConnectedComponents.maxIter(10).run()\nresult.select(\"id\", \"component\").orderBy(\"component\").show()"},{"id":"paragraph_1711533494834_180104524","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"### Label Propagation Algorithm (LPA)"},{"id":"paragraph_1711533505842_187187394","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\nval result = g.labelPropagation.maxIter(5).run()\nresult.select(\"id\", \"label\").show()","user":"anonymous","dateUpdated":"Mar 27, 2024, 12:58:29 PM","progress":1,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+\n| id|label|\n+---+-----+\n|  a|    2|\n|  b|    2|\n|  c|    1|\n|  d|    2|\n|  e|    5|\n|  f|    2|\n|  g|    6|\n+---+-----+\n\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mresult\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, name: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=229"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=230"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=231"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=232"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=233"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=234"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=235"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=236"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=237"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=238"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=239"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=240"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=241"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=242"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=243"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=244"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=245"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=246"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533505842_187187394","dateCreated":"Mar 27, 2024, 12:58:25 PM","dateStarted":"Mar 27, 2024, 12:58:29 PM","dateFinished":"Mar 27, 2024, 12:58:31 PM","status":"FINISHED"},{"id":"paragraph_1711533528858_1679370933","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"### PageRank"},{"id":"paragraph_1711533551873_590300010","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Run PageRank until convergence to tolerance \"tol\".\nval results = g.pageRank.resetProbability(0.15).tol(0.01).run()\n// Display resulting pageranks and final edge weights\n// Note that the displayed pagerank may be truncated, e.g., missing the E notation.\n// In Spark 1.5+, you can use show(truncate=false) to avoid truncation.\nresults.vertices.select(\"id\", \"pagerank\").show()\nresults.edges.select(\"src\", \"dst\", \"weight\").show()\n\n// Run PageRank for a fixed number of iterations.\nval results2 = g.pageRank.resetProbability(0.15).maxIter(10).run()\n\n// Run PageRank personalized for vertex \"a\"\nval results3 = g.pageRank.resetProbability(0.15).maxIter(10).sourceId(\"a\").run()\n\n// Run PageRank personalized for vertex [\"a\", \"b\", \"c\", \"d\"] in parallel\nval results4 = g.parallelPersonalizedPageRank.resetProbability(0.15).maxIter(10).sourceIds(Array(\"a\", \"b\", \"c\", \"d\")).run()","user":"anonymous","dateUpdated":"Mar 27, 2024, 1:00:09 PM","progress":21,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------------------+\n| id|           pagerank|\n+---+-------------------+\n|  a|0.44910633706538744|\n|  b|  2.655507832863289|\n|  c| 2.6878300011606218|\n|  d| 0.3283606792049851|\n|  e|0.37085233187676075|\n|  f| 0.3283606792049851|\n|  g| 0.1799821386239711|\n+---+-------------------+\n\n+---+---+------+\n|src|dst|weight|\n+---+---+------+\n|  a|  b|   0.5|\n|  a|  e|   0.5|\n|  b|  c|   1.0|\n|  c|  b|   1.0|\n|  d|  a|   1.0|\n|  e|  d|   0.5|\n|  e|  f|   0.5|\n|  f|  c|   1.0|\n+---+---+------+\n\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mresults\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 2 more fields], e:[src: string, dst: string ... 2 more fields])\n\u001b[1m\u001b[34mresults2\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 2 more fields], e:[src: string, dst: string ... 2 more fields])\n\u001b[1m\u001b[34mresults3\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 2 more fields], e:[src: string, dst: string ... 2 more fields])\n\u001b[1m\u001b[34mresults4\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFra...\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=247"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=248"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=249"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=250"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=251"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=252"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=253"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=254"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=255"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=256"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=257"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=258"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=259"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=260"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=261"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=262"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=263"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=264"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=265"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=266"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=267"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=268"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=269"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=270"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=271"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=272"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=273"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=274"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=275"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=276"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=277"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=278"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=279"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=280"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=281"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=282"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=283"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=284"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=285"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=286"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=287"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=288"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=289"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=290"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=291"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=292"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=293"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=294"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=295"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=296"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=297"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=298"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=299"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=300"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=301"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=302"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=303"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=304"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=305"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=306"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=307"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=308"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=309"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=310"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=311"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=312"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=313"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=314"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=315"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=316"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=317"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=318"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=319"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=320"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=321"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=322"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=323"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=324"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=325"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=326"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=327"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=328"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=329"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=330"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=331"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=332"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=333"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=334"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=335"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=336"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=337"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=338"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=339"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=340"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=341"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=342"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=343"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=344"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=345"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=346"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=347"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=348"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=349"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=350"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=351"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=352"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=353"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=354"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=355"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=356"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=357"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=358"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533551873_590300010","dateCreated":"Mar 27, 2024, 12:59:11 PM","dateStarted":"Mar 27, 2024, 1:00:09 PM","dateFinished":"Mar 27, 2024, 1:00:18 PM","status":"FINISHED"},{"id":"paragraph_1711533632937_819155048","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"#### Shortest paths"},{"id":"paragraph_1711533642944_111993228","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\nval results = g.shortestPaths.landmarks(Seq(\"a\", \"d\")).run()\nresults.select(\"id\", \"distances\").show()","user":"anonymous","dateUpdated":"Mar 27, 2024, 1:00:46 PM","progress":2,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------+\n| id|       distances|\n+---+----------------+\n|  a|{d -> 2, a -> 0}|\n|  b|              {}|\n|  c|              {}|\n|  d|{d -> 0, a -> 1}|\n|  e|{d -> 1, a -> 2}|\n|  f|              {}|\n|  g|              {}|\n+---+----------------+\n\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mresults\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, name: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=359"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=360"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=361"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=362"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=363"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=364"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=365"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=366"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=367"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=368"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=369"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=370"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=371"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=372"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=373"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=374"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=375"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=376"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=377"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=378"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=379"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=380"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533642944_111993228","dateCreated":"Mar 27, 2024, 1:00:42 PM","dateStarted":"Mar 27, 2024, 1:00:46 PM","dateFinished":"Mar 27, 2024, 1:00:47 PM","status":"FINISHED"},{"id":"paragraph_1711533665965_973869825","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"#### Triangle count"},{"id":"paragraph_1711533665965_973869825","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\nval results = g.triangleCount.run()\nresults.select(\"id\", \"count\").show()","user":"anonymous","dateUpdated":"Mar 27, 2024, 1:01:35 PM","progress":100,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+\n| id|count|\n+---+-----+\n|  a|    1|\n|  b|    0|\n|  c|    0|\n|  d|    1|\n|  e|    1|\n|  f|    0|\n|  g|    0|\n+---+-----+\n\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mresults\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [count: bigint, id: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=381"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=382"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=383"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=384"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=385"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=386"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=387"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=388"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=389"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=390"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=391"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=392"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=393"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=394"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=395"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=396"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=397"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=398"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=399"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=400"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=401"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=402"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=403"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533665965_973869825","dateCreated":"Mar 27, 2024, 1:01:05 PM","dateStarted":"Mar 27, 2024, 1:01:35 PM","dateFinished":"Mar 27, 2024, 1:01:37 PM","status":"FINISHED"},{"id":"paragraph_1711533728013_993947851","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"## Saving and loading GraphFrames"},{"id":"paragraph_1711533734017_1975848437","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Save vertices and edges as Parquet to some location.\ng.vertices.write.mode(\"overwrite\").parquet(\"vertices\")\ng.edges.write.mode(\"overwrite\").parquet(\"edges\")\n\n// Load the vertices and edges back.\nval sameV = spark.read.parquet(\"vertices\")\nval sameE = spark.read.parquet(\"edges\")\n\n// Create an identical GraphFrame.\nval sameG = GraphFrame(sameV, sameE)","user":"anonymous","dateUpdated":"Mar 27, 2024, 1:03:12 PM","progress":0,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34msameV\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, name: string ... 1 more field]\n\u001b[1m\u001b[34msameE\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [src: string, dst: string ... 1 more field]\n\u001b[1m\u001b[34msameG\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=404"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=405"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=406"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=407"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533734017_1975848437","dateCreated":"Mar 27, 2024, 1:02:14 PM","dateStarted":"Mar 27, 2024, 1:03:12 PM","dateFinished":"Mar 27, 2024, 1:03:12 PM","status":"FINISHED"},{"id":"paragraph_1711533811062_815827527","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"## Message passing via AggregateMessages"},{"id":"paragraph_1711533831078_1643340089","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.graphframes.{examples,GraphFrame}\nimport org.graphframes.lib.AggregateMessages\nval g: GraphFrame = examples.Graphs.friends\n\n// We will use AggregateMessages utilities later, so name it \"AM\" for short.\nval AM = AggregateMessages\n\n// For each user, sum the ages of the adjacent users.\nval msgToSrc = AM.dst(\"age\")\nval msgToDst = AM.src(\"age\")\nval agg = { g.aggregateMessages\n  .sendToSrc(msgToSrc)  // send destination user's age to source\n  .sendToDst(msgToDst)  // send source user's age to destination\n  .agg(sum(AM.msg).as(\"summedAges\")) } // sum up ages, stored in AM.msg column\n  \nagg.show()"},{"id":"paragraph_1711533882113_899938504","config":{"lineNumbers":true,"editorSetting":{"language":"markdown","editOnDblClick":false,"completionKey":"TAB","completionSupport":false}},"text":"## GraphX-GraphFrame conversions"},{"id":"paragraph_1711533887114_1185385219","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"text":"import org.apache.spark.graphx.Graph\nimport org.apache.spark.sql.Row\nimport org.graphframes.{examples,GraphFrame}\nval g: GraphFrame = examples.Graphs.friends\n\n// Convert to GraphX\nval gx: Graph[Row, Row] = g.toGraphX","user":"anonymous","dateUpdated":"Mar 27, 2024, 1:08:33 PM","progress":12,"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.graphx.Graph\nimport org.apache.spark.sql.Row\nimport org.graphframes.{examples, GraphFrame}\n\u001b[1m\u001b[34mg\u001b[0m: \u001b[1m\u001b[32morg.graphframes.GraphFrame\u001b[0m = GraphFrame(v:[id: string, name: string ... 1 more field], e:[src: string, dst: string ... 1 more field])\n\u001b[1m\u001b[34mgx\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.graphx.Graph[org.apache.spark.sql.Row,org.apache.spark.sql.Row]\u001b[0m = org.apache.spark.graphx.impl.GraphImpl@21908\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ubuntu:4040/jobs/job?id=433"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=434"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=435"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=436"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=437"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=438"},{"jobUrl":"http://ubuntu:4040/jobs/job?id=439"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711533887114_1185385219","dateCreated":"Mar 27, 2024, 1:04:47 PM","dateStarted":"Mar 27, 2024, 1:08:33 PM","dateFinished":"Mar 27, 2024, 1:08:34 PM","status":"FINISHED"}],"info":{},"noteForms":{},"noteParams":{},"angularObjects":{}}